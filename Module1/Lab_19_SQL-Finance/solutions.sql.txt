1. From the order_items table, find the price of the highest priced order and lowest price order?

select * from order_items;
select order_id, price from order_items
order by price desc;

The highest priced order = 6735

select order_id, price from order_items
order by price asc;


lowest price order = 0.85


2. From the order_items table, what is range of the shipping_limit_date of the orders?

select min(shipping_limit_date), max(shipping_limit_date) from order_items;

# min(shipping_limit_date), max(shipping_limit_date)
'2016-09-19 02:15:34', '2020-04-10 00:35:08'

3. From the customers table, find the states with the greatest number of customers.

select customer_state, count(customer_unique_id) from customers
group by customer_state
order by count(customer_unique_id) desc;

# customer_state, count(customer_unique_id)
'SP', '41746'
'RJ', '12852'
'MG', '11635'
'RS', '5466'
'PR', '5045'
'SC', '3637'
'BA', '3380'
'DF', '2140'
'ES', '2033'
'GO', '2020'
'PE', '1652'
'CE', '1336'
'PA', '975'
'MT', '907'
'MA', '747'
'MS', '715'
'PB', '536'
'PI', '495'
'RN', '485'
'AL', '413'
'SE', '350'
'TO', '280'
'RO', '253'
'AM', '148'
'AC', '81'
'AP', '68'
'RR', '46'

4. From the customers table, within the state with the greatest number of customers, find the cities with the greatest number of customers.

select customer_state, count(customer_id) from customers
group by customer_state
limit 1;

# customer_state, count(customer_id)
'SP', '41746'

select customer_city, count(customer_id) from customers
where customer_state = "SP"
order by count(customer_id);

# customer_city, count(customer_id)
'franca', '41746'

5. From the closed_deals table, how many distinct business segments are there (not including null)?

select count(distinct(business_segment)) from closed_deals;

# count(distinct(business_segment))
'33'

6. From the closed_deals table, sum the declared_monthly_revenue for duplicate row values in business_segment and find the 3 business segments with the highest declared monthly revenue (of those that declared revenue).

select sum(declared_monthly_revenue), business_segment from closed_deals
group by business_segment
having count(business_segment) >1
order by sum(declared_monthly_revenue) desc
limit 3;

# sum(declared_monthly_revenue), business_segment
'50695006', 'construction_tools_house_garden'
'8000000', 'phone_mobile'
'710000', 'home_decor'

 From the order_reviews table, find the total number of distinct review score values.

select sum(distinct(review_score)) from order_reviews;
# sum(distinct(review_score))
'15'

8. In the order_reviews table, create a new column with a description that corresponds to each number category for each review score from 1 - 5, then find the review score and category occurring most frequently in the table.

# review_score, count(review_score), review_categ
'5', '57420', 'Perfect'
'4', '19200', 'Good'
'1', '11858', 'Bad'
'3', '8287', 'Satisfactory'
'2', '3235', 'Poor'


9. From the order_reviews table, find the review value occurring most frequently and how many times it occurs.

select review_score, count(review_score) from order_reviews
group by review_score
order by count(review_score) desc
limit 1;

# review_score, count(review_score)
'5', '57420'
