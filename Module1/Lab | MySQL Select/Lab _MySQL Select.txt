Challenge 1 - Who Have Published What At Where?

use publications;
CREATE temporary Table summary
SELECT authors.au_id, authors.au_lname, authors.au_fname, 
titleauthor.title_id, titles.title, titles.pub_id, publishers.pub_name
FROM authors
left join titleauthor
on titleauthor.au_id=authors.au_id
left join titles
on titles.title_id=titleauthor.title_id
left join publishers
on titles.pub_id=publishers.pub_id
where titles.title_id is not null;


Challenge 2 - Who Have Published How Many At Where?

select * from summary;
select au_id, au_lname as Last_name, au_fname as first_name, count(title), pub_name from summary
group by au_id
order by count(title) desc;


Challenge 3 - Best Selling Authors

select authors.au_id, authors.au_lname as last_name, authors.au_fname as first_name,
sales.qty as total
from authors
left join titleauthor
on  titleauthor.au_id=authors.au_id
left join sales
on sales.title_id = titleauthor.title_id
group by last_name
order by total desc
limit 3;


Challenge 4 - Best Selling Authors Ranking

select authors.au_id, authors.au_lname as last_name, coalesce(qty,0) as total,  authors.au_fname as first_name
from authors
left join titleauthor
on  titleauthor.au_id=authors.au_id
left join sales
on sales.title_id = titleauthor.title_id
group by last_name
order by total desc;